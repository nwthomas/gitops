# Sealed Secret configuration for secure password management
sealedSecret:
  enabled: false
  # Generate these using kubeseal:
  # echo -n 'your-bcrypt-password-hash' | kubeseal --raw --from-file=/dev/stdin --name=argocd-secret --namespace=argocd
  adminPassword: ""
  adminPasswordMtime: ""

# Namespace where ArgoCD will be deployed
namespace: argocd

argo-cd:
  server:
    extraArgs:
      - --insecure
    ingress:
      enabled: true
      ingressClassName: traefik
      hosts:
        - argocd.local
      tls: false
  
  configs:
    secret:
      # Password should be managed externally via sealed-secrets or similar
      # argocdServerAdminPassword: "managed-externally"
      # argocdServerAdminPasswordMtime: "managed-externally"
    
    cm:
      resource:
        customizations:
          ignoreResourceUpdates:
            ConfigMap: |
              jqPathExpressions:
                # Ignore the cluster-autoscaler status
                - '.metadata.annotations."cluster-autoscaler.kubernetes.io/last-updated"'
                # Ignore the annotation of the legacy Leases election
                - '.metadata.annotations."control-plane.alpha.kubernetes.io/leader"'
            Endpoints: |
              jsonPointers:
                - /metadata
                - /subsets
            all: |
              jsonPointers:
                - /status
            apps_ReplicaSet: |
              jqPathExpressions:
                - '.metadata.annotations."deployment.kubernetes.io/desired-replicas"'
                - '.metadata.annotations."deployment.kubernetes.io/max-replicas"'
                - '.metadata.annotations."rollout.argoproj.io/desired-replicas"'
            argoproj.io_Application: |
              jqPathExpressions:
                - '.metadata.annotations."notified.notifications.argoproj.io"'
                - '.metadata.annotations."argocd.argoproj.io/refresh"'
                - '.metadata.annotations."argocd.argoproj.io/hydrate"'
                - '.operation'
            argoproj.io_Rollout: |
              jqPathExpressions:
                - '.metadata.annotations."notified.notifications.argoproj.io"'
            autoscaling_HorizontalPodAutoscaler: |
              jqPathExpressions:
                - '.metadata.annotations."autoscaling.alpha.kubernetes.io/behavior"'
                - '.metadata.annotations."autoscaling.alpha.kubernetes.io/conditions"'
                - '.metadata.annotations."autoscaling.alpha.kubernetes.io/metrics"'
                - '.metadata.annotations."autoscaling.alpha.kubernetes.io/current-metrics"'
            discovery.k8s.io_EndpointSlice: |
              jsonPointers:
                - /metadata
                - /endpoints
                - /ports
        exclusions: |
          ### Network resources created by the Kubernetes control plane and excluded to reduce the number of watched events and UI clutter
          - apiGroups:
            - ''
            - discovery.k8s.io
            kinds:
            - Endpoints
            - EndpointSlice
          ### Internal Kubernetes resources excluded reduce the number of watched events
          - apiGroups:
            - coordination.k8s.io
            kinds:
            - Lease
          ### Internal Kubernetes Authz/Authn resources excluded reduce the number of watched events
          - apiGroups:
            - authentication.k8s.io
            - authorization.k8s.io
            kinds:
            - SelfSubjectReview
            - TokenReview
            - LocalSubjectAccessReview
            - SelfSubjectAccessReview
            - SelfSubjectRulesReview
            - SubjectAccessReview
          ### Intermediate Certificate Request excluded reduce the number of watched events
          - apiGroups:
            - certificates.k8s.io
            kinds:
            - CertificateSigningRequest
          - apiGroups:
            - cert-manager.io
            kinds:
            - CertificateRequest
          ### Cilium internal resources excluded reduce the number of watched events and UI Clutter
          - apiGroups:
            - cilium.io
            kinds:
            - CiliumIdentity
            - CiliumEndpoint
            - CiliumEndpointSlice
          ### Kyverno intermediate and reporting resources excluded reduce the number of watched events and improve performance
          - apiGroups:
            - kyverno.io
            - reports.kyverno.io
            - wgpolicyk8s.io
            kinds:
            - PolicyReport
            - ClusterPolicyReport
            - EphemeralReport
            - ClusterEphemeralReport
            - AdmissionReport
            - ClusterAdmissionReport
            - BackgroundScanReport
            - ClusterBackgroundScanReport
            - UpdateRequest
